<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2026 Âπ¥ËèúÂø´ÈÄüÁµêÂ∏≥Ë®àÁÆóÊ©ü</title>
    <!-- ËºâÂÖ• Tailwind CSS (Ê®£Âºè) -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Ë®≠ÂÆö React ÂíåÂúñÁ§∫Â∫´ÁöÑ‰æÜÊ∫ê -->
    <script type="importmap">
    {
        "imports": {
            "react": "https://esm.sh/react@18.2.0",
            "react-dom/client": "https://esm.sh/react-dom@18.2.0/client",
            "lucide-react": "https://esm.sh/lucide-react@0.300.0"
        }
    }
    </script>
    <!-- ËºâÂÖ• Babel (ËÆìÁÄèË¶ΩÂô®ÁúãÊáÇ React Á®ãÂºèÁ¢º) -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <style>
        /* Èö±ËóèÊç≤Ëª∏‰ΩÜ‰øùÁïôÂäüËÉΩÔºåËÆìÁï´Èù¢Êõ¥‰πæÊ∑® */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f5f9; 
        }
        ::-webkit-scrollbar-thumb {
            background: #cbd5e1; 
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #94a3b8; 
        }
        /* ÁßªÈô§ number input ÁöÑÁÆ≠È†≠ */
        input[type=number]::-webkit-inner-spin-button, 
        input[type=number]::-webkit-outer-spin-button { 
            -webkit-appearance: none; 
            margin: 0; 
        }
    </style>
</head>
<body class="bg-slate-100">
    <div id="root"></div>

    <script type="text/babel" data-type="module">
        import React, { useState } from 'react';
        import { createRoot } from 'react-dom/client';
        import { ShoppingCart, RefreshCcw, Trash2, Plus, Minus, Package, Calculator, Copy, Check, Coins } from 'lucide-react';

        const MENU_ITEMS = [
            { id: 1, name: 'ÂúüÁ™ØÈõû', price: 600 },
            { id: 2, name: 'Ê∏ÖÁáâÈ±∏È≠öÊπØ', price: 600 },
            { id: 3, name: 'Èõû‰ªîË±¨ËÇöÈ±â', price: 600 },
            { id: 4, name: 'È¶ôÈÖ•È¥®', price: 550 },
            { id: 5, name: 'Ëó•ËÜ≥ÂúüÈõûÊπØ', price: 500 },
            { id: 6, name: '‰ΩõË∑≥ÁâÜ', price: 500 },
            { id: 7, name: 'Ëó•ËÜ≥ÁÉèÈ™®ÈõûÊπØ', price: 500 },
            { id: 8, name: 'ÁæäËÇâÁàê', price: 450 },
            { id: 9, name: 'ÂõõÂØ∂Ë±¨ËÇöÊπØ', price: 450 },
            { id: 10, name: 'Á¥ÖÁáíÁæäËÇãÊéí', price: 450 },
            { id: 11, name: 'Ë±¨ËÖ≥', price: 450 },
            { id: 12, name: 'Ê¢ÖÂπ≤Êâ£ËÇâ', price: 450 },
            { id: 13, name: 'ËÖ≥Â∫´Â∞ÅËÇâ', price: 400 },
            { id: 14, name: 'Ë±¨ËÇãÊéí', price: 400 },
            { id: 15, name: '‰∏ÄÂìÅÈÜâËù¶', price: 350 },
            { id: 16, name: '‰ªÄÈå¶Êµ∑ÈÆÆÁæπ', price: 350 },
            { id: 17, name: '‰∏âÂ±§Â∞ÅËÇâ', price: 400 },
            { id: 18, name: 'Ê´ªËä±Ëù¶Á±≥Á≥ï', price: 250 },
            { id: 19, name: 'ÂøÉÁü•ËÇöÊòé', price: 250 },
            { id: 20, name: 'ËçâËù¶', price: 250 },
            { id: 21, name: '‰∫îÊõ¥ËÖ∏Êó∫', price: 250 },
            { id: 22, name: 'È∫ªÊ≤πÈÖíÊ≤πÈ£Ø', price: 250 },
            { id: 23, name: 'ÁàÜÊºøÈ¶ôËèáÈ≠ö‰∏∏', price: 250 },
            { id: 24, name: 'Êª∑Â§ßËÖ∏È†≠', price: 250 },
            { id: 25, name: 'ÈÖ•‰∏∏', price: 200 },
            { id: 26, name: 'Ëä±Êûù‰∏∏', price: 200 },
            { id: 27, name: 'Ê©ôÊ±ÅÊéíÈ™®', price: 200 },
            { id: 28, name: 'Ëí≤ÁáíÈ≠öËÇö', price: 150 },
            { id: 29, name: 'È¶ôËèáÊµÅÊ≤ôÂåÖ', price: 150 },
            { id: 30, name: 'Êª∑Á≠çÂ≠ê', price: 60 },
        ];

        const SHIPPING_COST_A = 210;
        const SHIPPING_COST_B = 270;

        const formatMoney = (amount) => {
            return new Intl.NumberFormat('zh-TW', { style: 'currency', currency: 'TWD', minimumFractionDigits: 0 }).format(amount);
        };

        function PosCalculator() {
            const [cart, setCart] = useState({});
            const [shippingUnitsA, setShippingUnitsA] = useState(0); // $210
            const [shippingUnitsB, setShippingUnitsB] = useState(0); // $270
            const [handlingFee, setHandlingFee] = useState(''); // Manual handling fee
            const [copyStatus, setCopyStatus] = useState(false);

            const handleAddItem = (itemName) => {
                setCart(prev => ({
                    ...prev,
                    [itemName]: (prev[itemName] || 0) + 1
                }));
            };

            const handleRemoveItem = (itemName) => {
                setCart(prev => {
                    const current = prev[itemName] || 0;
                    if (current <= 1) {
                        const newState = { ...prev };
                        delete newState[itemName];
                        return newState;
                    }
                    return { ...prev, [itemName]: current - 1 };
                });
            };

            const resetAll = () => {
                if (window.confirm('Á¢∫ÂÆöË¶ÅÊ≠∏Èõ∂ÈáçÊñ∞Ë®àÁÆóÂóéÔºü')) {
                    setCart({});
                    setShippingUnitsA(0);
                    setShippingUnitsB(0);
                    setHandlingFee('');
                    setCopyStatus(false);
                }
            };

            const selectedItems = Object.entries(cart).map(([name, quantity]) => {
                const item = MENU_ITEMS.find(i => i.name === name);
                return { ...item, quantity, total: item.price * quantity, originalIndex: MENU_ITEMS.findIndex(i => i.name === name) };
            }).sort((a, b) => a.originalIndex - b.originalIndex);

            const productTotal = selectedItems.reduce((sum, item) => sum + item.total, 0);
            const shippingTotalA = shippingUnitsA * SHIPPING_COST_A;
            const shippingTotalB = shippingUnitsB * SHIPPING_COST_B;
            const shippingTotal = shippingTotalA + shippingTotalB;
            const handlingFeeValue = parseInt(handlingFee) || 0;
            const grandTotal = productTotal + shippingTotal + handlingFeeValue;
            const totalCount = selectedItems.reduce((sum, item) => sum + item.quantity, 0);

            const handleCopyOrder = () => {
                if (selectedItems.length === 0 && shippingUnitsA === 0 && shippingUnitsB === 0 && handlingFeeValue === 0) return;

                const date = new Date().toLocaleString('zh-TW', { hour12: false, month: 'numeric', day: 'numeric', hour: '2-digit', minute: '2-digit' });
                
                let text = `„Äê2026Âπ¥ËèúË®ÇË≥ºÂñÆ„Äë\n`;
                text += `Âª∫Á´ãÊôÇÈñì: ${date}\n`;
                text += `--------------------\n`;
                
                selectedItems.forEach(item => {
                    text += `${item.name} x ${item.quantity}  $${item.total}\n`;
                });
                
                if (selectedItems.length > 0) text += `--------------------\n`;
                
                if (shippingUnitsA > 0) {
                    text += `ÈÅãË≤ª ($210 x ${shippingUnitsA}‰ª∂): ${formatMoney(shippingTotalA)}\n`;
                }
                if (shippingUnitsB > 0) {
                    text += `ÈÅãË≤ª ($270 x ${shippingUnitsB}‰ª∂): ${formatMoney(shippingTotalB)}\n`;
                }
                if (handlingFeeValue > 0) {
                    text += `‰ª£Êî∂ÊâãÁ∫åË≤ª: ${formatMoney(handlingFeeValue)}\n`;
                }

                if (shippingUnitsA > 0 || shippingUnitsB > 0 || handlingFeeValue > 0) {
                     text += `ÂïÜÂìÅÂ∞èË®à: ${formatMoney(productTotal)}\n`;
                }
                
                text += `üí∞ Á∏ΩÈáëÈ°ç: ${formatMoney(grandTotal)}\n`;
                text += `--------------------\n`;
                text += `Ë¨ùË¨ùÊÇ®ÁöÑË®ÇË≥ºÔºÅ`;

                const textArea = document.createElement("textarea");
                textArea.value = text;
                document.body.appendChild(textArea);
                textArea.select();
                try {
                    document.execCommand('copy');
                    setCopyStatus(true);
                    setTimeout(() => setCopyStatus(false), 2000);
                } catch (err) {
                    console.error('Ë§áË£ΩÂ§±Êïó', err);
                    alert('Ë§áË£ΩÂ§±ÊïóÔºåË´ãÊâãÂãïË§áË£Ω');
                }
                document.body.removeChild(textArea);
            };

            return (
                <div className="min-h-screen bg-slate-100 flex flex-col md:flex-row font-sans text-slate-900">
                    
                    {/* LEFT: Menu Area */}
                    <div className="flex-1 p-4 md:p-6 overflow-y-auto" style={{maxHeight: '100vh'}}>
                        <header className="mb-6 flex items-center justify-between">
                            <div>
                                <h1 className="text-2xl md:text-3xl font-bold text-red-700 flex items-center gap-2">
                                    <Calculator className="w-8 h-8" />
                                    2026 Âπ¥ËèúÂø´ÈÄüÁµêÂ∏≥
                                </h1>
                                <p className="text-slate-500 text-sm mt-1">‰æùÁÖßÁ∑®ËôüÊéíÂàó (01-30)</p>
                            </div>
                            <button 
                                onClick={resetAll}
                                className="md:hidden flex items-center gap-1 bg-red-100 text-red-700 px-3 py-2 rounded-lg hover:bg-red-200 transition-colors"
                            >
                                <RefreshCcw size={18} />
                                Ê≠∏Èõ∂
                            </button>
                        </header>

                        <div className="pb-24 md:pb-0">
                            <div className="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-3">
                                {MENU_ITEMS.map((item) => {
                                    const quantity = cart[item.name] || 0;
                                    return (
                                        <button
                                            key={item.id}
                                            onClick={() => handleAddItem(item.name)}
                                            className={`
                                                relative flex flex-col justify-between p-3 rounded-lg border-2 transition-all active:scale-95 text-left h-28
                                                ${quantity > 0 
                                                    ? 'border-red-500 bg-red-50' 
                                                    : 'border-slate-200 bg-white hover:border-red-200 hover:shadow-md'}
                                            `}
                                        >
                                            <div className="flex justify-between items-start w-full">
                                                <span className="text-xs font-mono text-slate-400 bg-slate-100 px-1.5 rounded">
                                                    {String(item.id).padStart(2, '0')}
                                                </span>
                                            </div>
                                            
                                            <span className="font-bold text-slate-800 text-lg leading-tight mt-1 mb-1">
                                                {item.name}
                                            </span>
                                            
                                            <div className="flex justify-between items-end w-full">
                                                <span className="text-slate-600 font-medium">${item.price}</span>
                                                {quantity > 0 && (
                                                    <span className="bg-red-600 text-white text-xs font-bold px-2 py-1 rounded-full min-w-[1.5rem] text-center shadow-sm">
                                                        {quantity}
                                                    </span>
                                                )}
                                            </div>
                                        </button>
                                    );
                                })}
                            </div>
                        </div>
                    </div>

                    {/* RIGHT: Cart/Summary */}
                    <div className="bg-white md:w-96 shadow-xl flex flex-col border-l border-slate-200 z-20 md:h-screen sticky top-0">
                        
                        {/* Cart Header */}
                        <div className="p-4 bg-red-700 text-white flex justify-between items-center shadow-md shrink-0">
                            <div className="flex items-center gap-2">
                                <ShoppingCart size={20} />
                                <span className="font-bold text-lg">Ë≥ºÁâ©Ê∏ÖÂñÆ</span>
                                <span className="bg-red-800 text-red-100 text-xs px-2 py-0.5 rounded-full ml-2">
                                    {totalCount} È†ÖÂïÜÂìÅ
                                </span>
                            </div>
                            <button 
                                onClick={resetAll}
                                className="hidden md:flex items-center gap-1 text-sm bg-red-800/50 hover:bg-red-800 px-3 py-1.5 rounded transition-colors"
                            >
                                <RefreshCcw size={14} />
                                ÂÖ®ÈÉ®Ê≠∏Èõ∂
                            </button>
                        </div>

                        {/* Cart Items List */}
                        <div className="flex-1 overflow-y-auto p-4 space-y-3 bg-slate-50">
                            {selectedItems.length === 0 ? (
                                <div className="h-full flex flex-col items-center justify-center text-slate-400 gap-2 min-h-[200px]">
                                    <ShoppingCart size={48} className="opacity-20" />
                                    <p>Â∞öÊú™ÈÅ∏ÊìáÂïÜÂìÅ</p>
                                </div>
                            ) : (
                                selectedItems.map((item) => (
                                    <div key={item.name} className="flex items-center justify-between bg-white p-3 rounded-lg shadow-sm border border-slate-100">
                                        <div className="flex-1">
                                            <div className="font-bold text-slate-800">{item.name}</div>
                                            <div className="text-xs text-slate-500">${item.price} x {item.quantity}</div>
                                        </div>
                                        <div className="flex items-center gap-3">
                                            <div className="font-bold text-slate-700 w-16 text-right">
                                                ${item.total}
                                            </div>
                                            <div className="flex items-center gap-1 bg-slate-100 rounded-lg p-0.5">
                                                <button 
                                                    onClick={() => handleRemoveItem(item.name)}
                                                    className="p-1 hover:bg-white rounded shadow-sm text-slate-600 hover:text-red-600 transition-all"
                                                >
                                                    {item.quantity === 1 ? <Trash2 size={16} /> : <Minus size={16} />}
                                                </button>
                                                <span className="w-6 text-center text-sm font-bold">{item.quantity}</span>
                                                <button 
                                                    onClick={() => handleAddItem(item.name)}
                                                    className="p-1 hover:bg-white rounded shadow-sm text-slate-600 hover:text-green-600 transition-all"
                                                >
                                                    <Plus size={16} />
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                ))
                            )}
                        </div>

                        {/* Footer Calculation Area */}
                        <div className="bg-white p-4 border-t border-slate-200 shadow-[0_-4px_6px_-1px_rgba(0,0,0,0.1)] shrink-0 space-y-3">
                            
                            {/* Shipping Inputs Container */}
                            <div className="bg-slate-50 p-3 rounded-lg border border-slate-200 space-y-3">
                                {/* Shipping A ($210) */}
                                <div className="flex items-center justify-between">
                                    <div className="flex items-center gap-2 text-slate-700 text-sm">
                                        <Package size={18} />
                                        <span className="font-bold">ÈÅãË≤ª <span className="text-red-600">$210</span></span>
                                    </div>
                                    <div className="flex items-center gap-2">
                                        <button onClick={() => setShippingUnitsA(Math.max(0, shippingUnitsA - 1))} className="w-7 h-7 flex items-center justify-center rounded-full bg-slate-200 hover:bg-slate-300 text-slate-600"><Minus size={14} /></button>
                                        <span className="w-6 text-center font-bold text-sm">{shippingUnitsA}</span>
                                        <button onClick={() => setShippingUnitsA(shippingUnitsA + 1)} className="w-7 h-7 flex items-center justify-center rounded-full bg-slate-200 hover:bg-slate-300 text-slate-600"><Plus size={14} /></button>
                                    </div>
                                </div>
                                {/* Shipping B ($270) */}
                                <div className="flex items-center justify-between">
                                    <div className="flex items-center gap-2 text-slate-700 text-sm">
                                        <Package size={18} />
                                        <span className="font-bold">ÈÅãË≤ª <span className="text-red-600">$270</span></span>
                                    </div>
                                    <div className="flex items-center gap-2">
                                        <button onClick={() => setShippingUnitsB(Math.max(0, shippingUnitsB - 1))} className="w-7 h-7 flex items-center justify-center rounded-full bg-slate-200 hover:bg-slate-300 text-slate-600"><Minus size={14} /></button>
                                        <span className="w-6 text-center font-bold text-sm">{shippingUnitsB}</span>
                                        <button onClick={() => setShippingUnitsB(shippingUnitsB + 1)} className="w-7 h-7 flex items-center justify-center rounded-full bg-slate-200 hover:bg-slate-300 text-slate-600"><Plus size={14} /></button>
                                    </div>
                                </div>
                                {/* Handling Fee (Manual) */}
                                <div className="flex items-center justify-between pt-2 border-t border-slate-200">
                                    <div className="flex items-center gap-2 text-slate-700 text-sm">
                                        <Coins size={18} />
                                        <span className="font-bold">‰ª£Êî∂ÊâãÁ∫åË≤ª</span>
                                    </div>
                                    <div className="relative">
                                        <span className="absolute left-2 top-1/2 -translate-y-1/2 text-slate-400 text-sm">$</span>
                                        <input
                                            type="number"
                                            min="0"
                                            placeholder="0"
                                            value={handlingFee}
                                            onChange={(e) => setHandlingFee(e.target.value)}
                                            className="w-24 pl-5 py-1 text-right font-bold bg-white border border-slate-300 rounded focus:border-red-500 outline-none text-sm"
                                        />
                                    </div>
                                </div>
                            </div>

                            {/* Totals Summary */}
                            <div className="space-y-1">
                                <div className="flex justify-between text-slate-500 text-xs">
                                    <span>ÂïÜÂìÅÂ∞èË®à</span>
                                    <span>{formatMoney(productTotal)}</span>
                                </div>
                                {(shippingTotal > 0) && (
                                    <div className="flex justify-between text-slate-500 text-xs">
                                        <span>ÈÅãË≤ªÁ∏ΩË®à</span>
                                        <span>{formatMoney(shippingTotal)}</span>
                                    </div>
                                )}
                                {(handlingFeeValue > 0) && (
                                    <div className="flex justify-between text-slate-500 text-xs">
                                        <span>ÊâãÁ∫åË≤ª</span>
                                        <span>{formatMoney(handlingFeeValue)}</span>
                                    </div>
                                )}
                                <div className="pt-2 mt-2 border-t border-slate-100 flex justify-between items-end">
                                    <span className="text-lg font-bold text-slate-800">Á∏ΩÈáëÈ°ç</span>
                                    <span className="text-3xl font-bold text-red-600">{formatMoney(grandTotal)}</span>
                                </div>
                            </div>

                            {/* Action Buttons */}
                            <button
                                onClick={handleCopyOrder}
                                disabled={totalCount === 0 && shippingTotal === 0 && handlingFeeValue === 0}
                                className={`
                                    w-full flex items-center justify-center gap-2 py-3 rounded-xl text-lg font-bold shadow-sm transition-all
                                    ${copyStatus 
                                        ? 'bg-green-600 text-white' 
                                        : 'bg-slate-800 text-white hover:bg-slate-700 active:scale-95 disabled:bg-slate-300 disabled:cursor-not-allowed'}
                                `}
                            >
                                {copyStatus ? (
                                    <>
                                        <Check size={20} />
                                        Â∑≤Ë§áË£ΩÊòéÁ¥∞
                                    </>
                                ) : (
                                    <>
                                        <Copy size={20} />
                                        Ë§áË£ΩË®ÇÂñÆÊòéÁ¥∞
                                    </>
                                )}
                            </button>
                        </div>
                    </div>
                </div>
            );
        }

        const root = createRoot(document.getElementById('root'));
        root.render(<PosCalculator />);
    </script>
</body>
</html>